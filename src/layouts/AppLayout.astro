---
import "../styles/global.css";

interface Props {
  title?: string;
  description?: string;
  theme?: {
    accent: string;
  };
}

const {
  title = "App | ClearMetrics Lab",
  description = "Discover this app from ClearMetrics Lab.",
  theme = { accent: "#6366f1" },
} = Astro.props;

// Convert hex to RGB for opacity magic
function hexToRgb(hex: string): { r: number; g: number; b: number } {
  const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return result
    ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16),
      }
    : { r: 99, g: 102, b: 241 }; // fallback to indigo
}

const rgb = hexToRgb(theme.accent);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>

    <!-- Geist Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      @font-face {
        font-family: "Geist";
        src: url("/fonts/GeistVF.woff2") format("woff2");
        font-weight: 100 900;
        font-style: normal;
        font-display: swap;
      }
    </style>

    <!-- Dynamic Theme Override -->
    <style define:vars={{ "accent-r": rgb.r, "accent-g": rgb.g, "accent-b": rgb.b }}>
      :root {
        --accent-r: var(--accent-r);
        --accent-g: var(--accent-g);
        --accent-b: var(--accent-b);
        --color-accent: rgb(
          var(--accent-r),
          var(--accent-g),
          var(--accent-b)
        );
      }
    </style>
  </head>
  <body>
    <!-- Navigation (Back to main site) -->
    <nav
      class="fixed top-0 left-0 right-0 z-50 border-b border-border bg-background/80 backdrop-blur-xl"
    >
      <div
        class="mx-auto max-w-6xl px-6 py-4 flex items-center justify-between"
      >
        <a
          href="/"
          class="text-lg font-semibold tracking-tight text-text-primary hover:text-accent transition-colors"
        >
          ← ClearMetrics Lab
        </a>
        <div class="flex items-center gap-6">
          <a
            href="#docs"
            class="text-sm text-text-muted hover:text-text-primary transition-colors"
          >
            Docs
          </a>
          <a
            href="#blog"
            class="text-sm text-text-muted hover:text-text-primary transition-colors"
          >
            Blog
          </a>
          <a
            href="privacy-policy"
            class="text-sm text-text-muted hover:text-text-primary transition-colors"
          >
            Privacy
          </a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-16">
      <slot />
    </main>

    <!-- Footer -->
    <footer class="border-t border-border py-12 mt-24">
      <div class="mx-auto max-w-6xl px-6">
        <div
          class="flex flex-col md:flex-row justify-between items-center gap-4"
        >
          <p class="text-sm text-text-muted">
            © {new Date().getFullYear()} ClearMetrics Lab. All rights reserved.
          </p>
          <div class="flex items-center gap-6">
            <a
              href="/"
              class="text-sm text-text-muted hover:text-text-primary transition-colors"
            >
              Back to Home
            </a>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
